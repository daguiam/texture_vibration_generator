# Texture Vibration Generator

This project contains the sample texture vibration generator demonstration app for the Product-In-Touch project.

When a finger slides over a texture, there is a mechanical coupling between the rough texture topography and the fingerprint membranes of a typical human fingertip. 
These membranes are on average spaced 1mm apart. 
As the membrane slides over the texture, with velocity `velocity`, the topography deforms the skin and triggers a mechanically damped oscillating response of the membrane.
The same texture *bump* is swped by the multiple membranes in a figertip, each of which vibrate at its resonance frequency, as modelled in `skin_model.ipynb`.

The synthesizer assumes a spatial distribution for the fingertip membranes `finger_spacing` swiping at `velocity`, which is measured from the Geomagic Touch haptics device (or a mouse cursor).
As the fingeris swiped, each membrane generates an impulse response, all of which translate to an impulse train.
See more details in the `process_textures_spectrum.ipynb` notebook.

The spatial texture topography is resampled as there is a finger sliding over it at `velocity`, resulting in a transient signal, sampled at `fs_audio`, equal to the audio sampling frequency of the output device.
The texture transient topography is converted to acceleration by its second derivative.
The impulse train, corresponding to the mechanical response of the finger membrane, is convoluled with the acceleration generated by the texture topography, generating a transient signal, which corresponds to the vibration.
This transient signal is translated into an audio signal, filtered with a bandpass filter (which considers the frequency response of the piezo actuator), which is streamed to a piezoelectric tactile actuator.

The `velocity` can be obtained by the Geomagic Touch (received through an UDP socket, from the "GT Velocity Streamer"), or through the mouse cursor moving on the computer screen.

The sample textures, inside `textures\` were measured using an optical profilometer and listed in the `textures\textures.json` file dictionary.



## Getting Started

1. Power up and connect the Geomagic Touch haptics device to the computer
2. Connect the Cypress Boreas Haptic driver board to the PC. Hit the reset button until it is LED is static green.
3. Start the `GT Velocity Streamer.exe`
4. Start the GUI program `python gui_texture_vibration_generator.py`


## Troubleshooting

- The Cypress board is not recognized:

Connect the USB board to the computer. Hit the reset button until the LED is static green. Hit `Refresh` button in the output devices of the GUI application.

- There is too much clicking noise in the haptics actuator

Alternative 1: Reduce the `textures gain` or the `output volume` in th GUI applicaiton.

Alternative 2: Adjust the low and high cut offs of the audio filter.

- The velocity is static at 0mm/s

Make sure that the `GT Velocity Streamer` is running, and has an `GTVelocityStreamer ok` message in the status bar of the GUI. Move around the arm.

Alternative 1: Select the `Mouse cursor` button and move the mouse around.

Alternative 2: Click `Add a base velocity` and move the slider to add an arbitrary velocity.


